startTime = as_datetime(startTime),
sh = ifelse(hour(startTime) < 8, hour(startTime) + 24, hour(startTime)), #create numeric times
sm = minute(startTime),
st = sh + sm/60,
eh = hour(endTime),
em = minute(endTime),
et = eh + em/60,
mst = ma(st, 7), #create moving averages
met = ma(et, 7)
)
df %>%
head()
df %>%
ggplot(aes(x = date))+
geom_line(aes(y = et), color = 'coral', alpha = .3)+
geom_line(aes(y = st), color = 'dodgerblue', alpha = .3)+
geom_line(aes(y = met), color = 'coral', na.rm=T)+
geom_line(aes(y = mst), color = 'dodgerblue', na.rm=T)+
scale_y_continuous(breaks = seq(0, 30, 2),
labels = trans_format(function(x) ifelse(x > 23, x - 24, x),
format = scales::comma_format(suffix = ":00"))
)+
labs(x = "Date",
y = 'Time')+
theme_fivethirtyeight()
df <- con %>%
tbl('heartrate') %>%
collect()
df %>%
group_by(date) %>%
summarize(hr = median(hr)) %>%
mutate(date = as.Date(date)) %>%
ggplot(aes(x = date, y = hr))+
geom_line()+
scale_x_date()
knitr::opts_chunk$set(message = F, warning = F, tidy = T)
library(tidyverse)
library(dbplyr)
library(lubridate)
library(scales)
library(ggthemes)
library(forecast)
con <- DBI::dbConnect(RMySQL::MySQL(),
host = "localhost",
port = 3306,
dbname = "fitbit",
user = "root",
password = keyring::key_get('mysql'))
df <- tbl(con, 'sleep') %>%
data.frame() %>%
arrange(date) %>%
filter(mainSleep == 1) %>% # main sleep = no naps
mutate(date = as_datetime(date),
startTime = as_datetime(startTime),
sh = ifelse(hour(startTime) < 8, hour(startTime) + 24, hour(startTime)), #create numeric times
sm = minute(startTime),
st = sh + sm/60,
eh = hour(endTime),
em = minute(endTime),
et = eh + em/60,
mst = ma(st, 7), #create moving averages
met = ma(et, 7)
)
df %>%
head()
df %>%
ggplot(aes(x = date))+
geom_line(aes(y = et), color = 'coral', alpha = .3)+
geom_line(aes(y = st), color = 'dodgerblue', alpha = .3)+
geom_line(aes(y = met), color = 'coral', na.rm=T)+
geom_line(aes(y = mst), color = 'dodgerblue', na.rm=T)+
scale_y_continuous(breaks = seq(0, 30, 2),
labels = trans_format(function(x) ifelse(x > 23, x - 24, x),
format = scales::comma_format(suffix = ":00"))
)+
labs(x = "Date",
y = 'Time')+
theme_fivethirtyeight()
View(df)
df %>%
mutate(time.asleep = minutesAsleep %/% 60 + (minutes %% 60) / 60)
df %>%
mutate(time.asleep = (minutesAsleep %/% 60) + (minutes %% 60) / 60)
df$minutesAsleep %/% 60
df %>%
mutate(time.asleep = (minutesAsleep %/% 60) + (minutesAsleep %% 60) / 60)
df %>%
mutate(time.asleep = (minutesAsleep %/% 60) + (minutesAsleep %% 60) / 60,
time.in.bed = (timeInBed %/% 60) + (timeInBed %% 60) / 60)
df %>%
ggplot(aes(x = date))+
geom_line(aes(y = minutes.asleep), color = 'coral')+
geom_line(aes(y = time.in.bed), color = 'dodgerblue')+
scale_x_date()+
labs(x = "Date",
y = 'Time')+
theme_fivethirtyeight()
df %>%
ggplot(aes(x = date))+
geom_line(aes(y = time.asleep), color = 'coral')+
geom_line(aes(y = time.in.bed), color = 'dodgerblue')+
scale_x_date()+
labs(x = "Date",
y = 'Time')+
theme_fivethirtyeight()
df %>%
mutate(time.asleep = (minutesAsleep %/% 60) + (minutesAsleep %% 60) / 60,
time.in.bed = (timeInBed %/% 60) + (timeInBed %% 60) / 60)
df <- df %>%
mutate(time.asleep = (minutesAsleep %/% 60) + (minutesAsleep %% 60) / 60,
time.in.bed = (timeInBed %/% 60) + (timeInBed %% 60) / 60)
df %>%
ggplot(aes(x = date))+
geom_line(aes(y = time.asleep), color = 'coral')+
geom_line(aes(y = time.in.bed), color = 'dodgerblue')+
scale_x_date()+
labs(x = "Date",
y = 'Time')+
theme_fivethirtyeight()
df <- df %>%
mutate(time.asleep = (minutesAsleep %/% 60) + (minutesAsleep %% 60) / 60,
time.in.bed = (timeInBed %/% 60) + (timeInBed %% 60) / 60,
date = as.Date(date))
df %>%
ggplot(aes(x = date))+
geom_line(aes(y = time.asleep), color = 'coral')+
geom_line(aes(y = time.in.bed), color = 'dodgerblue')+
scale_x_date()+
labs(x = "Date",
y = 'Time')+
theme_fivethirtyeight()
df %>%
filter(mainSleep == 1) %>%
ggplot(aes(x = date))+
geom_line(aes(y = time.asleep), color = 'coral')+
geom_line(aes(y = time.in.bed), color = 'dodgerblue')+
scale_x_date()+
labs(x = "Date",
y = 'Time')+
theme_fivethirtyeight()
knitr::opts_chunk$set(message = F, warning = F, tidy = T)
library(tidyverse)
library(dbplyr)
library(lubridate)
library(scales)
library(ggthemes)
library(forecast)
con <- DBI::dbConnect(RMySQL::MySQL(),
host = "localhost",
port = 3306,
dbname = "fitbit",
user = "root",
password = keyring::key_get('mysql'))
df <- tbl(con, 'sleep') %>%
data.frame() %>%
arrange(date) %>%
filter(mainSleep == 1) %>% # main sleep = no naps
mutate(date = as_datetime(date),
startTime = as_datetime(startTime),
sh = ifelse(hour(startTime) < 8, hour(startTime) + 24, hour(startTime)), #create numeric times
sm = minute(startTime),
st = sh + sm/60,
eh = hour(endTime),
em = minute(endTime),
et = eh + em/60,
mst = ma(st, 7), #create moving averages
met = ma(et, 7)
)
df %>%
head()
df %>%
ggplot(aes(x = date))+
geom_line(aes(y = et), color = 'coral', alpha = .3)+
geom_line(aes(y = st), color = 'dodgerblue', alpha = .3)+
geom_line(aes(y = met), color = 'coral', na.rm=T)+
geom_line(aes(y = mst), color = 'dodgerblue', na.rm=T)+
scale_y_continuous(breaks = seq(0, 30, 2),
labels = trans_format(function(x) ifelse(x > 23, x - 24, x),
format = scales::comma_format(suffix = ":00"))
)+
labs(x = "Date",
y = 'Time')+
theme_fivethirtyeight()
View(df)
df %>%
ggplot(aes(x = date))+
geom_line(aes(y = et), color = 'coral', alpha = .3)+
geom_line(aes(y = st), color = 'dodgerblue', alpha = .3)+
geom_line(aes(y = met), color = 'coral', na.rm=T)+
geom_line(aes(y = mst), color = 'dodgerblue', na.rm=T)+
scale_y_continuous(breaks = seq(0, 30, 2),
labels = trans_format(function(x) ifelse(x > 23, x - 24, x),
format = scales::comma_format(suffix = ":00"))
)+
labs(x = "Date",
y = 'Time')+
theme_fivethirtyeight()
library(tidyverse)
library(dbplyr)
library(lubridate)
library(scales)
library(ggthemes)
library(forecast)
con <- DBI::dbConnect(RMySQL::MySQL(),
host = "localhost",
port = 3306,
dbname = "fitbit",
user = "root",
password = keyring::key_get('mysql'))
con
db_list_tables(con)
con %>%
tbl('basicactivity')
library(tidyverse)
library(dbplyr)
library(lubridate)
library(scales)
library(ggthemes)
library(forecast)
con %>%
tbl('basicactivity')
install.packages('rlang')
library(tidyverse)
library(tidyverse)
library(dbplyr)
library(lubridate)
library(scales)
library(ggthemes)
library(forecast)
library(tidyverse)
library(dbplyr)
library(lubridate)
library(scales)
library(ggthemes)
library(forecast)
con <- DBI::dbConnect(RMySQL::MySQL(),
host = "localhost",
port = 3306,
dbname = "fitbit",
user = "root",
password = keyring::key_get('mysql'))
con %>% tbl('basicactivity')
df <- tbl(con, 'sleep') %>%
arrange(date) %>%
filter(mainSleep == 1) %>% # main sleep = no naps
mutate(date = as_datetime(date),
startTime = as_datetime(startTime),
sh = ifelse(hour(startTime) < 8, hour(startTime) + 24, hour(startTime)), #create numeric times
sm = minute(startTime),
st = sh + sm/60,
eh = hour(endTime),
em = minute(endTime),
et = eh + em/60,
mst = ma(st, 7), #create moving averages
met = ma(et, 7)
)
df %>%
head()
tbl(con, 'sleep') %>%
arrange(date)
tbl(con, 'sleep') %>%
arrange(date) %>%
filter(mainSleep == 1)
tbl(con, 'sleep') %>%
arrange(date) %>%
filter(mainSleep == 1) %>% # main sleep = no naps
mutate(date = as_datetime(date),
startTime = as_datetime(startTime),
sh = ifelse(hour(startTime) < 8, hour(startTime) + 24, hour(startTime)), #create numeric times
sm = minute(startTime),
st = sh + sm/60,
eh = hour(endTime),
em = minute(endTime),
et = eh + em/60,
mst = ma(st, 7), #create moving averages
met = ma(et, 7)
)
df <- tbl(con, 'sleep') %>%
arrange(date) %>%
filter(mainSleep == 1) %>% # main sleep = no naps
collect() %>%
mutate(date = as_datetime(date),
startTime = as_datetime(startTime),
sh = ifelse(hour(startTime) < 8, hour(startTime) + 24, hour(startTime)), #create numeric times
sm = minute(startTime),
st = sh + sm/60,
eh = hour(endTime),
em = minute(endTime),
et = eh + em/60,
mst = ma(st, 7), #create moving averages
met = ma(et, 7)
)
df %>%
head()
con %>% tbl('water')
water <_ con %>% tbl('water') %>% collect()
water <- con %>% tbl('water') %>% collect()
View(water)
plot(water)
water %>% ggplot(aes(date, water))+ geom_line()
water %>% ggplot(aes(date, water))+ geom_line()+ scale_x_date()
water <- water %>% mutate(date = as.Date(date))
water %>% ggplot(aes(date, water))+ geom_line()+ scale_x_date()
water <- con %>%
tbl('water') %>%
mutate(date = as.Date(date))
water
water %>%
ggplot(date, water)+
geom_line
water %>%
ggplot(aes(date, water))+
geom_line()
water %>%
ggplot(aes(date, water))+
geom_line()+
scale_x_date()
water <- con %>%
tbl('water') %>%
mutate(date = as.Date(date))
water %>%
ggplot(aes(date, water))+
geom_line()+
scale_x_date()
water <- con %>%
tbl('water') %>%
collect() %>%
mutate(date = as.Date(date))
water %>%
ggplot(aes(date, water))+
geom_line()+
scale_x_date()
water %>%
ggplot(aes(date))+
geom_line(water, alpha = .3)+
geom_line(ma(water, 7))+
scale_x_date()
water %>%
ggplot(aes(date))+
geom_line(aes(water), alpha = .3)+
geom_line(aes(ma(water, 7)))+
scale_x_date()
water %>%
ggplot(aes(x = date))+
geom_line(aes(y = water), alpha = .3)+
geom_line(aes(y = ma(water, 7)))+
scale_x_date()
water <- con %>%
tbl('water') %>%
filter(water != 0) %>%
collect() %>%
mutate(date = as.Date(date))
water %>%
ggplot(aes(x = date))+
geom_line(aes(y = water), alpha = .3)+
geom_line(aes(y = ma(water, 7)))+
scale_x_date()
activity <- con %>%
tbl('basicactivity') %>%
collect()
View(activity)
df <- activity %>%
inner_join(water, by = 'date')
activity <- con %>%
tbl('basicactivity') %>%
collect() %>%
mutate(date = as.Date(date))
df <- activity %>%
inner_join(water, by = 'date')
df %>%
ggplot(aes(x = caloriesOut, y = water))+
geom_point()
df %>%
ggplot(aes(x = steps, y = water))+
geom_point()
df %>%
ggplot(aes(x = activitycalories, y = water))+
geom_point()
df %>%
ggplot(aes(x = activityCalories, y = water))+
geom_point()
knitr::opts_chunk$set(message = F, warning = F, tidy = T)
library(tidyverse)
library(dbplyr)
library(lubridate)
library(scales)
library(ggthemes)
library(forecast)
con <- DBI::dbConnect(RMySQL::MySQL(),
host = "localhost",
port = 3306,
dbname = "fitbit",
user = "root",
password = keyring::key_get('mysql'))
df <- tbl(con, 'sleep') %>%
arrange(date) %>%
filter(mainSleep == 1) %>% # main sleep = no naps
collect() %>%
mutate(date = as_datetime(date),
startTime = as_datetime(startTime),
sh = ifelse(hour(startTime) < 8, hour(startTime) + 24, hour(startTime)), #create numeric times
sm = minute(startTime),
st = sh + sm/60,
eh = hour(endTime),
em = minute(endTime),
et = eh + em/60,
mst = ma(st, 7), #create moving averages
met = ma(et, 7)
)
df %>%
head()
View(df)
df %>%
ggplot(aes(x = date))+
geom_line(aes(y = et), color = 'coral', alpha = .3)+
geom_line(aes(y = st), color = 'dodgerblue', alpha = .3)+
geom_line(aes(y = met), color = 'coral', na.rm=T)+
geom_line(aes(y = mst), color = 'dodgerblue', na.rm=T)+
scale_y_continuous(breaks = seq(0, 30, 2),
labels = trans_format(function(x) ifelse(x > 23, x - 24, x),
format = scales::comma_format(suffix = ":00"))
)+
labs(x = "Date",
y = 'Time')+
theme_fivethirtyeight()
df %>%
ggplot(aes(x = date))+
geom_line(aes(y = et), color = 'coral', alpha = .3)+
geom_line(aes(y = st), color = 'dodgerblue', alpha = .3)+
geom_line(aes(y = met), color = 'coral', na.rm=T)+
geom_line(aes(y = mst), color = 'dodgerblue', na.rm=T)+
scale_y_continuous(breaks = seq(0, 30, 2),
labels = trans_format(function(x) ifelse(x > 23, x - 12, x),
format = scales::comma_format(suffix = ":00"))
)+
labs(x = "Date",
y = 'Time')+
theme_fivethirtyeight()
df %>%
ggplot(aes(x = date))+
geom_line(aes(y = et), color = 'coral', alpha = .3)+
geom_line(aes(y = st), color = 'dodgerblue', alpha = .3)+
geom_line(aes(y = met), color = 'coral', na.rm=T)+
geom_line(aes(y = mst), color = 'dodgerblue', na.rm=T)+
scale_y_continuous(breaks = seq(0, 30, 2),
labels = trans_format(function(x) ifelse(x > 23, x - 24, x),
format = scales::comma_format(suffix = ":00"))
)+
labs(x = "Date",
y = 'Time')+
theme_fivethirtyeight()
df %>%
ggplot(aes(x = date))+
geom_line(aes(y = et), color = 'coral', alpha = .3)+
geom_line(aes(y = st), color = 'dodgerblue', alpha = .3)+
geom_line(aes(y = met), color = 'coral', na.rm=T)+
geom_line(aes(y = mst), color = 'dodgerblue', na.rm=T)+
scale_y_continuous(breaks = seq(0, 30, 2),
labels = trans_format(function(x) ifelse(x > 23, x - 24, x),
format = scales::comma_format(suffix = ":00"))
)+
labs(x = "Date",
y = 'Time')+
theme_fivethirtyeight()
plt <-  (
df %>%
ggplot(aes(x = date))+
geom_line(aes(y = et), color = 'coral', alpha = .3)+
geom_line(aes(y = st), color = 'dodgerblue', alpha = .3)+
geom_line(aes(y = met), color = 'coral', na.rm=T)+
geom_line(aes(y = mst), color = 'dodgerblue', na.rm=T)+
scale_y_continuous(breaks = seq(0, 30, 2),
labels = trans_format(function(x) ifelse(x > 23, x - 24, x),
format = scales::comma_format(suffix = ":00"))
)+
labs(x = "Date",
y = 'Time')+
theme_fivethirtyeight()
)
plt <- (
df %>%
ggplot(aes(x = date))+
geom_line(aes(y = et), color = 'coral', alpha = .3)+
geom_line(aes(y = st), color = 'dodgerblue', alpha = .3)+
geom_line(aes(y = met), color = 'coral', na.rm=T)+
geom_line(aes(y = mst), color = 'dodgerblue', na.rm=T)+
scale_y_continuous(breaks = seq(0, 30, 2),
labels = trans_format(function(x) ifelse(x > 23, x - 24, x),
format = scales::comma_format(suffix = ":00"))
)+
labs(x = "Date",
y = 'Time')+
theme_fivethirtyeight()
)
(
plt <- df %>%
ggplot(aes(x = date))+
geom_line(aes(y = et), color = 'coral', alpha = .3)+
geom_line(aes(y = st), color = 'dodgerblue', alpha = .3)+
geom_line(aes(y = met), color = 'coral', na.rm=T)+
geom_line(aes(y = mst), color = 'dodgerblue', na.rm=T)+
scale_y_continuous(breaks = seq(0, 30, 2),
labels = trans_format(function(x) ifelse(x > 23, x - 24, x),
format = scales::comma_format(suffix = ":00"))
)+
labs(x = "Date",
y = 'Time')+
theme_fivethirtyeight()
)
ggsave('users/matt/documents/github/fitbit/viz/sleepplot.svg', plt, 'svg', dpi = 'retina', path = '~/Documents/GitHub/mrkaye97.github.io/', width = 6, height = 4.8)
ggsave('sleepplot.svg', plt, 'svg', dpi = 'retina', path = '~/Documents/GitHub/fitbit/viz', width = 6, height = 4.8)
file.path(R.home("bin"), "R")
